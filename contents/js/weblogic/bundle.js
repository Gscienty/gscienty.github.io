angular.module('blog', ['ngRoute']) .config(['$routeProvider', function($routeProvider){ $routeProvider .when('/', { templateUrl : '/views/welcome.html' }) .when('/blog-list:category:page', { templateUrl : '/views/blog-list.html', controller : 'blog-list-controller' }) .when('/article:article_path', { templateUrl : '/views/article.html', controller : 'article-controller' }) .otherwise({ redirectTo : '/' }); }]);angular.module('blog').controller('blog-list-controller', function($window, $location, $routeParams, $http, $scope){ $scope.go_back = function(){ $window.history.back(); }; $http.get('/contents/data/blog-category.json').success(function(data){ $scope.blog_category = data; }); var category = $routeParams['category']; while(category.indexOf('-') != -1){ category = category.replace('-', ' '); } while(category.indexOf(':') != -1){ category = category.replace(':', ''); } if(category == 'Default'){ $scope.display_hello_flag = true; return; } $scope.display_hello_flag = false; var current_page = $routeParams['page']; while(current_page.indexOf(':') != -1){ current_page = current_page.replace(':', ''); } current_page = parseInt(current_page); $scope.Category = category; $http.get('/contents/data/'+category + '-articles.json').success(function(data){ var page_size = 10; var result = []; var length = data.length; for(var i = (current_page - 1) * page_size; i < current_page * page_size && i < length && i >= 0; i++){ result.push(data[i]); }; /*need filter*/ $scope.articles = result; }); $scope.preview_page_btn_color = '#aaa'; $scope.next_page_btn_color = '#aaa'; $scope.category_go_page = function(p){ p = parseInt(p); $location.path('/blog-list:' + category + ':' + (current_page + p)); };});angular.module('blog').controller('article-controller', function($http, $scope, $window, $routeParams, $sce){ $scope.go_back = function(){ $window.history.back(); }; $http.get('/contents/data/blog-category.json').success(function(data){ $scope.blog_category = data; }); var article_path = $routeParams['article_path']; while(article_path.indexOf(':') != -1){ article_path = article_path.replace(':', ''); } $http.get('/contents/data/articles/' + article_path).success(function(content){ $scope.content = $sce.trustAsHtml(markdown.toHTML(content)); });});